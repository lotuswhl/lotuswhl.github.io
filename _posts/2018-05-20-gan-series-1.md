---
layout:     post
title:      生成对抗网络研究系列之-part1
subtitle:   为什么要学习生成模型？
date:       2018-05-20
author:     HL
header-img: img/gan.jpg
catalog: true
tags:
    - deep learning
    - gan
---
# 简介
这个系列将会主要依据Ian Goodfellow在NIPS2016的上对GAN的教程结合Deep learning book来进行编辑，有些地方会进行简略，有些地方会加入自己的理解与思考。
* 生成对抗网络(GAN)从2014年由Ian Goodfellow提出以来引起了极大的关注。深度学习三巨头之一Yann Lecun在Quora上说道：生成对抗网络是深度学习领域近十年来最有趣的想法。
* GAN自提出以来，发展极为迅速，到目前为止关于GAN的变种及其应用已经不下数百篇paper。在多个领域的应用都取得了惊人的效果。

### 背景
传统的生成模型主要是根据输入的样本数据(来源于同一个分布$P_{data}$)输出对该样本的估计分布。比如给你一组取样于高斯分布的数据，然后你可以给出一个对该样本的估计的最接近的高斯分布$P_{model}$。对于这样的模型,我们的目标是使得对于某一个样本值x,我们需要使得$P_{model}(x)$更接近于$P_{data}(x)$.也就是我们的生成模型学习到样本数据的一个估计。  
然而，理想的来说，我们可能希望这样的生成模型，比如给你的样本数据是来自于一组花草的数据集，然后，我们可以从生成模型$P_{model}$中取样生成训练样本中没有的新的样本比如不同种类的花草，或者是一些与花草无关的样本，比如建筑汽车等等(当然这种需要更进一步的设计生成模型)。

# 为什么要学习生成模型
一个很简单的思考，为什么我们需要生成模型，按照上面所述，如果一个生成模型存在的意义只是生成更多的样本，比如图片，文本等，而现在早就不缺少图片数据以及文本数据。
## 原因分析
### 1.高维概率分布
训练以及取样自生成模型是检测我们表示和处理高维数据能力的极好的的方式。在各种应用数学和工程领域，高维分布都是很重要的研究对象。**生成模型有助于探索高维数据分布对象的表示与处理.**
### 2.强化学习应用
生成模型可以以多种方式并入强化学习.强化学习可以分为两类,model-based and model-free.基于模型的强化学习算法包含一个生成模型.基于时间序列的生成模型可以用于预测未来的状态.这样的模型可以以多种方式应用于planning.生成模型用于planning将会生成一个条件概率分布,也就是根据之前的状态结合当前环境下agent可能选择action可能转移到的未来的状态.其典型的特点就是对于未知状态的预测.  
与此同时,生成模型还可以被用于agent对当前状态下可能转移到的状态的概率的查询以及在当前状态下,对每一个action的选择可能到达的状态,这样就可以便于选择action到达目标状态.  
除此之外,这样的生成模型其本身也就是对于环境的模拟,所以可以应用于模拟环境,在模拟器下agent根据生成模型的预测结果选择不同的action,进行不同的尝试,在模拟环境下并不会对真实的agent造成损失.  
**生成模型尤其是生成对抗模型GAN在强化学习中得到了广泛的应用,并取得了不错的效果.**
### 3.处理缺失数据,无标签数据
生成模型可以应用于缺失数据,一个很典型的例子就是半监督学习.现代的机器学习或深度学习算法通常需要大量的标签数据来提升泛化能力,而半监督学习可以减少标签数据的需求,毕竟标签数据并不是那么容易获得.生成模型尤其是GAN可以很好的应用于半监督学习.后续将会进行更为详尽的探讨.
### 4.multi-model data output
生成模型尤其是GAN,可以使得机器学习模型输出多模态数据.对于许多机器学习的任务来说单个输入可能对应于多个正确的输出结果.但是对于传统的训练机器学习的算法如使用预测值和目标值之间的均方误差,则无法输出多种正确的答案.比如对于预测视频的下一帧的任务上,使用min-squared error,就会产生较为模糊的输出并且会丢失微小的细节信息.
![gan for multi-model output sample](https://raw.githubusercontent.com/lotuswhl/lotuswhl.github.io/master/img/gan/gan-multi-model-application-sample.jpg)  
上面的这张图片显示的是对于3D头像连续帧视频的下一帧的预测问题.其中第一个是视频中下一帧的真实图像而中间的是使用mse方法训练得到的结果,最右边的是使用对抗网络GAN生成的结果.从图像中可以看出,mse输出的图像较为模糊并且耳朵部分消失了,而对抗网络生成图像显得比较尖锐,并成功的生成了耳朵;其本质原因在于MSE在多个可能正确的结果中取了均值,而对抗网络只是给出了其中一种正确的结果.这表明对于生成多模态的数据对抗网络的表现甚为精彩!
### 5.任务本身对样本生成的需求
许多机器学习的任务本身就需要能够从样本的真实分布生成真实的样本.
* **高分辨率图像生成.** 也就是将一个低分辨图像作为输入,输出一个高分辨率的同样的图像;这个任务的难度在于需要将图像本身的更多的信息嵌入到输入的图像中.这也会面临着同样的问题:如果使用的训练方法是将可能的正确结果取平均那么输出的图像就会比较模糊,而使用GAN来生成则不同,因为GAN知道存在多个正确的结果,输出其中一个即可.  
![high resolution image genration](https://raw.githubusercontent.com/lotuswhl/lotuswhl.github.io/master/img/gan/high-resolution-image-generation.jpg)  
* **艺术的生成.** GAN可以应用于根据用户或者艺术家的粗糙的想象,使用简单的几笔勾勒出的粗糙的简单的场景,以生成艺术家想象中完整的图像场景图.这样的应用还是很有趣的!  
![art genration](https://raw.githubusercontent.com/lotuswhl/lotuswhl.github.io/master/img/gan/art-generation-by-gan.jpg)  
* **图像到图像的转换.** 可以将空间图映射为一张地图,也可以将一组轮廓图/骨骼图映射为完整的图片;这样的应用往往具备着不确定性,难以生成,但是一旦成功就会变得非常有用!当然也很美妙!  
![image to image translation](https://raw.githubusercontent.com/lotuswhl/lotuswhl.github.io/master/img/gan/image-to-image-translation.jpg)  

# Final Word
**以上这些原因以及应用足以说服或者吸引大家投入经历与资源去研究与提升生成模型!**